2021-12-03 14:32:44,606 - root - INFO - Flag Values:
{
    "L1_flag": false,
    "batch_size": 512,
    "ckpt_path": "log/",
    "clipping_max_value": 5.0,
    "data_path": "../../corpora/",
    "dataset": "drug_disease",
    "early_stopping_steps_to_wait": 70000,
    "embedding_size": 64,
    "eval_interval_steps": 14000,
    "eval_only_mode": false,
    "experiment_name": "drug_disease-transup-1638541964",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": null,
    "l2_lambda": 1e-05,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": null,
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "log/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "transup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 2,
    "num_processes": 4,
    "optimizer_type": "Adagrad",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 1400000,
    "use_st_gumbel": true,
    "visualization_port": 8097
}
2021-12-03 14:32:44,613 - root - INFO - Totally 1284 train ratings, 143,651 eval ratings in files: ../../corpora/drug_disease/valid.dat;../../corpora/drug_disease/test.dat!
2021-12-03 14:32:44,615 - root - INFO - successfully load 654 users and 618 items!
2021-12-03 14:32:44,616 - root - INFO - Building model.
2021-12-03 14:32:47,544 - root - INFO - Architecture: TransUPModel(
  (user_embeddings): Embedding(654, 64)
  (item_embeddings): Embedding(618, 64)
  (pref_embeddings): Embedding(2, 64)
  (pref_norm_embeddings): Embedding(2, 64)
)
2021-12-03 14:32:47,554 - root - INFO - Total params: 81664.0
2021-12-03 14:32:47,554 - root - INFO - One epoch is 3 steps.
2021-12-03 14:32:47,555 - root - INFO - Training.
2021-12-03 14:32:47,556 - root - INFO - train loss:0.0000!
2021-12-03 14:32:48,006 - root - INFO - f1:0.0067, p:0.0038, r:0.0288, hit:0.0385, ndcg:0.0248, topn:10.
2021-12-03 14:32:48,561 - root - INFO - f1:0.0046, p:0.0036, r:0.0085, hit:0.0325, ndcg:0.0119, topn:10.
2021-12-03 14:35:19,463 - root - INFO - train loss:0.5208!
2021-12-03 14:35:19,943 - root - INFO - f1:0.0060, p:0.0038, r:0.0160, hit:0.0385, ndcg:0.0275, topn:10.
2021-12-03 14:35:20,603 - root - INFO - f1:0.0013, p:0.0011, r:0.0026, hit:0.0108, ndcg:0.0062, topn:10.
2021-12-03 14:35:20,605 - root - INFO - Checkpointing ...
2021-12-03 14:38:18,291 - root - INFO - train loss:0.4452!
2021-12-03 14:38:18,748 - root - INFO - f1:0.0143, p:0.0087, r:0.0497, hit:0.0865, ndcg:0.0541, topn:10.
2021-12-03 14:38:19,403 - root - INFO - f1:0.0009, p:0.0011, r:0.0009, hit:0.0072, ndcg:0.0029, topn:10.
2021-12-03 14:38:19,405 - root - INFO - Checkpointing ...
2021-12-03 14:40:41,573 - root - INFO - train loss:0.4124!
2021-12-03 14:40:42,026 - root - INFO - f1:0.0166, p:0.0096, r:0.0673, hit:0.0962, ndcg:0.0568, topn:10.
2021-12-03 14:40:42,555 - root - INFO - f1:0.0008, p:0.0011, r:0.0006, hit:0.0072, ndcg:0.0036, topn:10.
2021-12-03 14:40:42,557 - root - INFO - Checkpointing ...
2021-12-03 14:42:54,701 - root - INFO - train loss:0.3907!
2021-12-03 14:42:55,255 - root - INFO - f1:0.0145, p:0.0087, r:0.0545, hit:0.0865, ndcg:0.0559, topn:10.
2021-12-03 14:42:55,934 - root - INFO - f1:0.0010, p:0.0011, r:0.0010, hit:0.0108, ndcg:0.0054, topn:10.
2021-12-03 14:42:55,936 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 14:44:54,734 - root - INFO - train loss:0.3440!
2021-12-03 14:44:55,302 - root - INFO - f1:0.0196, p:0.0115, r:0.0785, hit:0.1154, ndcg:0.0681, topn:10.
2021-12-03 14:44:55,871 - root - INFO - f1:0.0015, p:0.0014, r:0.0027, hit:0.0108, ndcg:0.0041, topn:10.
2021-12-03 14:44:55,872 - root - INFO - Checkpointing ...
2021-12-03 14:46:52,457 - root - INFO - train loss:0.3273!
2021-12-03 14:46:52,905 - root - INFO - f1:0.0164, p:0.0096, r:0.0689, hit:0.0962, ndcg:0.0721, topn:10.
2021-12-03 14:46:53,447 - root - INFO - f1:0.0011, p:0.0011, r:0.0022, hit:0.0072, ndcg:0.0026, topn:10.
2021-12-03 14:46:53,450 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 14:49:05,511 - root - INFO - train loss:0.3099!
2021-12-03 14:49:05,947 - root - INFO - f1:0.0180, p:0.0106, r:0.0737, hit:0.1058, ndcg:0.0747, topn:10.
2021-12-03 14:49:06,492 - root - INFO - f1:0.0009, p:0.0007, r:0.0020, hit:0.0072, ndcg:0.0027, topn:10.
2021-12-03 14:49:06,495 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 14:51:03,292 - root - INFO - train loss:0.2964!
2021-12-03 14:51:03,745 - root - INFO - f1:0.0198, p:0.0115, r:0.0881, hit:0.1154, ndcg:0.0682, topn:10.
2021-12-03 14:51:04,417 - root - INFO - f1:0.0011, p:0.0011, r:0.0022, hit:0.0072, ndcg:0.0031, topn:10.
2021-12-03 14:51:04,422 - root - INFO - Checkpointing ...
2021-12-03 14:53:02,121 - root - INFO - train loss:0.2950!
2021-12-03 14:53:02,679 - root - INFO - f1:0.0181, p:0.0106, r:0.0785, hit:0.1058, ndcg:0.0713, topn:10.
2021-12-03 14:53:03,358 - root - INFO - f1:0.0011, p:0.0011, r:0.0022, hit:0.0072, ndcg:0.0029, topn:10.
2021-12-03 14:53:03,360 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 14:54:59,755 - root - INFO - train loss:0.2921!
2021-12-03 14:55:00,302 - root - INFO - f1:0.0178, p:0.0106, r:0.0689, hit:0.1058, ndcg:0.0718, topn:10.
2021-12-03 14:55:00,944 - root - INFO - f1:0.0018, p:0.0018, r:0.0030, hit:0.0144, ndcg:0.0049, topn:10.
2021-12-03 14:55:00,947 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 14:56:58,708 - root - INFO - train loss:0.2885!
2021-12-03 14:56:59,158 - root - INFO - f1:0.0181, p:0.0106, r:0.0785, hit:0.1058, ndcg:0.0748, topn:10.
2021-12-03 14:56:59,726 - root - INFO - f1:0.0018, p:0.0018, r:0.0030, hit:0.0144, ndcg:0.0053, topn:10.
2021-12-03 14:56:59,729 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 14:59:06,184 - root - INFO - train loss:0.2874!
2021-12-03 14:59:06,634 - root - INFO - f1:0.0181, p:0.0106, r:0.0785, hit:0.1058, ndcg:0.0741, topn:10.
2021-12-03 14:59:07,308 - root - INFO - f1:0.0016, p:0.0014, r:0.0029, hit:0.0108, ndcg:0.0039, topn:10.
2021-12-03 14:59:07,310 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 15:01:04,213 - root - INFO - train loss:0.2867!
2021-12-03 15:01:04,662 - root - INFO - f1:0.0180, p:0.0106, r:0.0737, hit:0.1058, ndcg:0.0636, topn:10.
2021-12-03 15:01:05,235 - root - INFO - f1:0.0021, p:0.0018, r:0.0036, hit:0.0144, ndcg:0.0049, topn:10.
2021-12-03 15:01:05,238 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 15:01:05,255 - root - INFO - No improvement after 70000 steps. Stopping training.
