2021-12-03 15:34:33,936 - root - INFO - Flag Values:
{
    "L1_flag": false,
    "batch_size": 512,
    "ckpt_path": "log/",
    "clipping_max_value": 5.0,
    "data_path": "../../corpora/",
    "dataset": "drug_disease",
    "early_stopping_steps_to_wait": 70000,
    "embedding_size": 64,
    "eval_interval_steps": 14000,
    "eval_only_mode": false,
    "experiment_name": "drug_disease-jtransup-1638545673",
    "filter_wrong_corrupted": true,
    "has_visualization": false,
    "is_report": false,
    "joint_ratio": 0.5,
    "kg_lambda": 1.0,
    "kg_test_files": "valid.dat:test.dat",
    "l2_lambda": 1e-05,
    "learning_rate": 0.001,
    "learning_rate_decay_when_no_progress": 0.5,
    "load_ckpt_file": null,
    "load_experiment_name": null,
    "log_level": "debug",
    "log_path": "log/",
    "margin": 1.0,
    "max_queue": 10,
    "model_type": "jtransup",
    "momentum": 0.9,
    "negtive_samples": 1,
    "norm_lambda": 1.0,
    "num_preferences": 2,
    "num_processes": 4,
    "optimizer_type": "Adagrad",
    "rec_test_files": "valid.dat:test.dat",
    "seed": 0,
    "share_embeddings": false,
    "topn": 10,
    "training_steps": 1400000,
    "use_st_gumbel": false,
    "visualization_port": 8097
}
2021-12-03 15:34:33,942 - root - INFO - Totally 1284 train ratings, 143,651 eval ratings in files: ../../corpora/drug_disease/valid.dat;../../corpora/drug_disease/test.dat!
2021-12-03 15:34:33,944 - root - INFO - successfully load 654 users and 618 items!
2021-12-03 15:34:34,006 - root - INFO - Totally 9027 train triples, 1505,4513 eval triples in files: ../../corpora/drug_disease/kg/valid.dat;../../corpora/drug_disease/kg/test.dat!
2021-12-03 15:34:34,024 - root - INFO - successfully load 13355 entities and 1 relations!
2021-12-03 15:34:34,107 - root - INFO - Find 0 aligned items and entities!
2021-12-03 15:34:34,109 - root - INFO - Building model.
2021-12-03 15:34:37,064 - root - INFO - Architecture: jTransUPModel(
  (user_embeddings): Embedding(654, 64)
  (item_embeddings): Embedding(618, 64)
  (pref_embeddings): Embedding(1, 64)
  (pref_norm_embeddings): Embedding(1, 64)
  (ent_embeddings): Embedding(13356, 64, padding_idx=13355)
  (rel_embeddings): Embedding(1, 64)
  (norm_embeddings): Embedding(1, 64)
)
2021-12-03 15:34:37,065 - root - INFO - Total params: 936448.0
2021-12-03 15:34:37,065 - root - INFO - One epoch is 36 steps.
2021-12-03 15:34:37,065 - root - INFO - Training.
2021-12-03 15:34:37,066 - root - INFO - rec train loss:0.0000, kg train loss:0.0000!
2021-12-03 15:34:37,620 - root - INFO - f1:0.0068, p:0.0038, r:0.0337, hit:0.0385, ndcg:0.0170, topn:10.
2021-12-03 15:34:38,180 - root - INFO - f1:0.0058, p:0.0040, r:0.0120, hit:0.0397, ndcg:0.0200, topn:10.
2021-12-03 15:34:47,222 - root - INFO - head hit:0.0007, head mean rank:5886.8007, topn:10.
2021-12-03 15:34:47,222 - root - INFO - tail hit:0.0007, tail mean rank:6626.0419, topn:10.
2021-12-03 15:34:47,222 - root - INFO - avg hit:0.0007, avg mean rank:6256.4213, topn:10.
2021-12-03 15:35:09,324 - root - INFO - head hit:0.0004, head mean rank:5980.3627, topn:10.
2021-12-03 15:35:09,325 - root - INFO - tail hit:0.0011, tail mean rank:6546.8117, topn:10.
2021-12-03 15:35:09,325 - root - INFO - avg hit:0.0008, avg mean rank:6263.5872, topn:10.
2021-12-03 15:39:48,598 - root - INFO - rec train loss:62.1398, kg train loss:247.5332!
2021-12-03 15:39:49,175 - root - INFO - f1:0.0172, p:0.0096, r:0.0865, hit:0.0962, ndcg:0.0424, topn:10.
2021-12-03 15:39:49,710 - root - INFO - f1:0.0026, p:0.0022, r:0.0040, hit:0.0217, ndcg:0.0081, topn:10.
2021-12-03 15:39:58,151 - root - INFO - head hit:0.1515, head mean rank:2195.5867, topn:10.
2021-12-03 15:39:58,151 - root - INFO - tail hit:0.0007, tail mean rank:7166.1415, topn:10.
2021-12-03 15:39:58,152 - root - INFO - avg hit:0.0761, avg mean rank:4680.8641, topn:10.
2021-12-03 15:40:18,121 - root - INFO - head hit:0.1618, head mean rank:2277.5214, topn:10.
2021-12-03 15:40:18,122 - root - INFO - tail hit:0.0007, tail mean rank:7054.4403, topn:10.
2021-12-03 15:40:18,122 - root - INFO - avg hit:0.0812, avg mean rank:4665.9808, topn:10.
2021-12-03 15:40:18,125 - root - INFO - Checkpointing ...
2021-12-03 15:44:33,220 - root - INFO - rec train loss:43.2177, kg train loss:171.9264!
2021-12-03 15:44:33,678 - root - INFO - f1:0.0170, p:0.0096, r:0.0817, hit:0.0962, ndcg:0.0503, topn:10.
2021-12-03 15:44:34,253 - root - INFO - f1:0.0016, p:0.0014, r:0.0021, hit:0.0144, ndcg:0.0050, topn:10.
2021-12-03 15:44:42,400 - root - INFO - head hit:0.1455, head mean rank:1902.5628, topn:10.
2021-12-03 15:44:42,401 - root - INFO - tail hit:0.0007, tail mean rank:7320.1754, topn:10.
2021-12-03 15:44:42,401 - root - INFO - avg hit:0.0731, avg mean rank:4611.3691, topn:10.
2021-12-03 15:45:01,948 - root - INFO - head hit:0.1507, head mean rank:1982.2803, topn:10.
2021-12-03 15:45:01,949 - root - INFO - tail hit:0.0004, tail mean rank:7197.3200, topn:10.
2021-12-03 15:45:01,949 - root - INFO - avg hit:0.0756, avg mean rank:4589.8001, topn:10.
2021-12-03 15:45:01,951 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 15:49:02,782 - root - INFO - rec train loss:33.4290, kg train loss:132.8518!
2021-12-03 15:49:03,360 - root - INFO - f1:0.0239, p:0.0135, r:0.1154, hit:0.1346, ndcg:0.0721, topn:10.
2021-12-03 15:49:04,040 - root - INFO - f1:0.0006, p:0.0007, r:0.0005, hit:0.0072, ndcg:0.0022, topn:10.
2021-12-03 15:49:12,146 - root - INFO - head hit:0.1216, head mean rank:1725.4797, topn:10.
2021-12-03 15:49:12,147 - root - INFO - tail hit:0.0007, tail mean rank:7452.1568, topn:10.
2021-12-03 15:49:12,147 - root - INFO - avg hit:0.0611, avg mean rank:4588.8183, topn:10.
2021-12-03 15:49:31,482 - root - INFO - head hit:0.1219, head mean rank:1801.0569, topn:10.
2021-12-03 15:49:31,482 - root - INFO - tail hit:0.0007, tail mean rank:7311.6133, topn:10.
2021-12-03 15:49:31,482 - root - INFO - avg hit:0.0613, avg mean rank:4556.3351, topn:10.
2021-12-03 15:49:31,485 - root - INFO - Checkpointing ...
2021-12-03 15:53:31,030 - root - INFO - rec train loss:28.1063, kg train loss:111.8303!
2021-12-03 15:53:31,607 - root - INFO - f1:0.0239, p:0.0135, r:0.1154, hit:0.1346, ndcg:0.0755, topn:10.
2021-12-03 15:53:32,316 - root - INFO - f1:0.0002, p:0.0004, r:0.0002, hit:0.0036, ndcg:0.0013, topn:10.
2021-12-03 15:53:40,577 - root - INFO - head hit:0.1076, head mean rank:1691.0339, topn:10.
2021-12-03 15:53:40,578 - root - INFO - tail hit:0.0007, tail mean rank:7494.2319, topn:10.
2021-12-03 15:53:40,578 - root - INFO - avg hit:0.0542, avg mean rank:4592.6329, topn:10.
2021-12-03 15:54:00,240 - root - INFO - head hit:0.1048, head mean rank:1765.1061, topn:10.
2021-12-03 15:54:00,240 - root - INFO - tail hit:0.0007, tail mean rank:7356.5710, topn:10.
2021-12-03 15:54:00,241 - root - INFO - avg hit:0.0527, avg mean rank:4560.8386, topn:10.
2021-12-03 15:54:00,243 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 15:58:08,146 - root - INFO - rec train loss:25.0727, kg train loss:99.4469!
2021-12-03 15:58:08,728 - root - INFO - f1:0.0256, p:0.0144, r:0.1250, hit:0.1442, ndcg:0.0839, topn:10.
2021-12-03 15:58:09,394 - root - INFO - f1:0.0002, p:0.0004, r:0.0002, hit:0.0036, ndcg:0.0014, topn:10.
2021-12-03 15:58:17,521 - root - INFO - head hit:0.0950, head mean rank:1673.4226, topn:10.
2021-12-03 15:58:17,521 - root - INFO - tail hit:0.0007, tail mean rank:7512.4505, topn:10.
2021-12-03 15:58:17,521 - root - INFO - avg hit:0.0478, avg mean rank:4592.9365, topn:10.
2021-12-03 15:58:37,131 - root - INFO - head hit:0.0946, head mean rank:1744.4968, topn:10.
2021-12-03 15:58:37,131 - root - INFO - tail hit:0.0007, tail mean rank:7386.0093, topn:10.
2021-12-03 15:58:37,131 - root - INFO - avg hit:0.0476, avg mean rank:4565.2530, topn:10.
2021-12-03 15:58:37,136 - root - INFO - Checkpointing ...
2021-12-03 16:02:40,282 - root - INFO - rec train loss:22.9215, kg train loss:90.9212!
2021-12-03 16:02:40,874 - root - INFO - f1:0.0256, p:0.0144, r:0.1250, hit:0.1442, ndcg:0.0877, topn:10.
2021-12-03 16:02:41,526 - root - INFO - f1:0.0002, p:0.0004, r:0.0002, hit:0.0036, ndcg:0.0016, topn:10.
2021-12-03 16:02:49,657 - root - INFO - head hit:0.0904, head mean rank:1664.4432, topn:10.
2021-12-03 16:02:49,657 - root - INFO - tail hit:0.0007, tail mean rank:7528.9934, topn:10.
2021-12-03 16:02:49,657 - root - INFO - avg hit:0.0455, avg mean rank:4596.7183, topn:10.
2021-12-03 16:03:09,307 - root - INFO - head hit:0.0877, head mean rank:1736.3827, topn:10.
2021-12-03 16:03:09,307 - root - INFO - tail hit:0.0007, tail mean rank:7402.1363, topn:10.
2021-12-03 16:03:09,308 - root - INFO - avg hit:0.0442, avg mean rank:4569.2595, topn:10.
2021-12-03 16:03:09,316 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 16:07:10,355 - root - INFO - rec train loss:21.6478, kg train loss:85.9602!
2021-12-03 16:07:10,819 - root - INFO - f1:0.0274, p:0.0154, r:0.1346, hit:0.1538, ndcg:0.0916, topn:10.
2021-12-03 16:07:11,495 - root - INFO - f1:0.0002, p:0.0004, r:0.0002, hit:0.0036, ndcg:0.0014, topn:10.
2021-12-03 16:07:19,578 - root - INFO - head hit:0.0850, head mean rank:1664.2844, topn:10.
2021-12-03 16:07:19,578 - root - INFO - tail hit:0.0007, tail mean rank:7533.5508, topn:10.
2021-12-03 16:07:19,578 - root - INFO - avg hit:0.0429, avg mean rank:4598.9176, topn:10.
2021-12-03 16:07:39,123 - root - INFO - head hit:0.0831, head mean rank:1737.2550, topn:10.
2021-12-03 16:07:39,123 - root - INFO - tail hit:0.0007, tail mean rank:7404.5187, topn:10.
2021-12-03 16:07:39,123 - root - INFO - avg hit:0.0419, avg mean rank:4570.8869, topn:10.
2021-12-03 16:07:39,126 - root - INFO - Checkpointing ...
2021-12-03 16:11:41,294 - root - INFO - rec train loss:20.6490, kg train loss:81.9436!
2021-12-03 16:11:41,784 - root - INFO - f1:0.0274, p:0.0154, r:0.1346, hit:0.1538, ndcg:0.0951, topn:10.
2021-12-03 16:11:42,458 - root - INFO - f1:0.0002, p:0.0004, r:0.0002, hit:0.0036, ndcg:0.0014, topn:10.
2021-12-03 16:11:50,862 - root - INFO - head hit:0.0824, head mean rank:1661.1867, topn:10.
2021-12-03 16:11:50,862 - root - INFO - tail hit:0.0007, tail mean rank:7540.6518, topn:10.
2021-12-03 16:11:50,862 - root - INFO - avg hit:0.0415, avg mean rank:4600.9193, topn:10.
2021-12-03 16:12:10,413 - root - INFO - head hit:0.0813, head mean rank:1734.0627, topn:10.
2021-12-03 16:12:10,414 - root - INFO - tail hit:0.0007, tail mean rank:7412.0357, topn:10.
2021-12-03 16:12:10,414 - root - INFO - avg hit:0.0410, avg mean rank:4573.0492, topn:10.
2021-12-03 16:12:10,417 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 16:15:51,956 - root - INFO - rec train loss:20.1488, kg train loss:79.7542!
2021-12-03 16:15:52,544 - root - INFO - f1:0.0309, p:0.0173, r:0.1538, hit:0.1731, ndcg:0.0995, topn:10.
2021-12-03 16:15:53,207 - root - INFO - f1:0.0005, p:0.0007, r:0.0004, hit:0.0072, ndcg:0.0027, topn:10.
2021-12-03 16:16:01,460 - root - INFO - head hit:0.0791, head mean rank:1663.9302, topn:10.
2021-12-03 16:16:01,460 - root - INFO - tail hit:0.0013, tail mean rank:7540.4585, topn:10.
2021-12-03 16:16:01,460 - root - INFO - avg hit:0.0402, avg mean rank:4602.1944, topn:10.
2021-12-03 16:16:20,897 - root - INFO - head hit:0.0793, head mean rank:1736.5369, topn:10.
2021-12-03 16:16:20,897 - root - INFO - tail hit:0.0007, tail mean rank:7411.4037, topn:10.
2021-12-03 16:16:20,897 - root - INFO - avg hit:0.0400, avg mean rank:4573.9703, topn:10.
2021-12-03 16:16:20,907 - root - INFO - Checkpointing ...
2021-12-03 16:20:30,681 - root - INFO - rec train loss:19.5963, kg train loss:77.9534!
2021-12-03 16:20:31,252 - root - INFO - f1:0.0309, p:0.0173, r:0.1538, hit:0.1731, ndcg:0.0998, topn:10.
2021-12-03 16:20:31,933 - root - INFO - f1:0.0005, p:0.0007, r:0.0004, hit:0.0072, ndcg:0.0027, topn:10.
2021-12-03 16:20:40,164 - root - INFO - head hit:0.0764, head mean rank:1662.3455, topn:10.
2021-12-03 16:20:40,164 - root - INFO - tail hit:0.0013, tail mean rank:7544.0512, topn:10.
2021-12-03 16:20:40,164 - root - INFO - avg hit:0.0389, avg mean rank:4603.1983, topn:10.
2021-12-03 16:20:59,963 - root - INFO - head hit:0.0784, head mean rank:1734.9306, topn:10.
2021-12-03 16:20:59,964 - root - INFO - tail hit:0.0007, tail mean rank:7415.5216, topn:10.
2021-12-03 16:20:59,964 - root - INFO - avg hit:0.0396, avg mean rank:4575.2261, topn:10.
2021-12-03 16:20:59,969 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 16:24:52,907 - root - INFO - rec train loss:19.3355, kg train loss:76.9121!
2021-12-03 16:24:53,370 - root - INFO - f1:0.0291, p:0.0163, r:0.1442, hit:0.1635, ndcg:0.0973, topn:10.
2021-12-03 16:24:54,076 - root - INFO - f1:0.0005, p:0.0007, r:0.0004, hit:0.0072, ndcg:0.0027, topn:10.
2021-12-03 16:25:02,424 - root - INFO - head hit:0.0751, head mean rank:1664.3415, topn:10.
2021-12-03 16:25:02,424 - root - INFO - tail hit:0.0013, tail mean rank:7543.6997, topn:10.
2021-12-03 16:25:02,424 - root - INFO - avg hit:0.0382, avg mean rank:4604.0206, topn:10.
2021-12-03 16:25:22,007 - root - INFO - head hit:0.0773, head mean rank:1737.1336, topn:10.
2021-12-03 16:25:22,008 - root - INFO - tail hit:0.0007, tail mean rank:7415.0784, topn:10.
2021-12-03 16:25:22,008 - root - INFO - avg hit:0.0390, avg mean rank:4576.1060, topn:10.
2021-12-03 16:25:22,011 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 16:29:11,276 - root - INFO - rec train loss:19.1891, kg train loss:76.0652!
2021-12-03 16:29:11,749 - root - INFO - f1:0.0291, p:0.0163, r:0.1442, hit:0.1635, ndcg:0.0973, topn:10.
2021-12-03 16:29:12,445 - root - INFO - f1:0.0005, p:0.0007, r:0.0004, hit:0.0072, ndcg:0.0027, topn:10.
2021-12-03 16:29:20,534 - root - INFO - head hit:0.0751, head mean rank:1665.1794, topn:10.
2021-12-03 16:29:20,534 - root - INFO - tail hit:0.0007, tail mean rank:7543.6704, topn:10.
2021-12-03 16:29:20,535 - root - INFO - avg hit:0.0379, avg mean rank:4604.4249, topn:10.
2021-12-03 16:29:39,591 - root - INFO - head hit:0.0769, head mean rank:1738.1354, topn:10.
2021-12-03 16:29:39,592 - root - INFO - tail hit:0.0007, tail mean rank:7414.9417, topn:10.
2021-12-03 16:29:39,592 - root - INFO - avg hit:0.0388, avg mean rank:4576.5386, topn:10.
2021-12-03 16:29:39,595 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 16:33:40,827 - root - INFO - rec train loss:19.0509, kg train loss:75.7093!
2021-12-03 16:33:41,409 - root - INFO - f1:0.0309, p:0.0173, r:0.1538, hit:0.1731, ndcg:0.1007, topn:10.
2021-12-03 16:33:42,000 - root - INFO - f1:0.0005, p:0.0007, r:0.0004, hit:0.0072, ndcg:0.0027, topn:10.
2021-12-03 16:33:50,188 - root - INFO - head hit:0.0751, head mean rank:1665.7708, topn:10.
2021-12-03 16:33:50,188 - root - INFO - tail hit:0.0007, tail mean rank:7543.7223, topn:10.
2021-12-03 16:33:50,189 - root - INFO - avg hit:0.0379, avg mean rank:4604.7465, topn:10.
2021-12-03 16:34:09,702 - root - INFO - head hit:0.0769, head mean rank:1738.6182, topn:10.
2021-12-03 16:34:09,702 - root - INFO - tail hit:0.0007, tail mean rank:7414.3880, topn:10.
2021-12-03 16:34:09,702 - root - INFO - avg hit:0.0388, avg mean rank:4576.5031, topn:10.
2021-12-03 16:34:09,706 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 16:38:19,482 - root - INFO - rec train loss:18.9481, kg train loss:75.5286!
2021-12-03 16:38:20,042 - root - INFO - f1:0.0291, p:0.0163, r:0.1442, hit:0.1635, ndcg:0.0979, topn:10.
2021-12-03 16:38:20,617 - root - INFO - f1:0.0005, p:0.0007, r:0.0004, hit:0.0072, ndcg:0.0027, topn:10.
2021-12-03 16:38:28,930 - root - INFO - head hit:0.0751, head mean rank:1666.0645, topn:10.
2021-12-03 16:38:28,930 - root - INFO - tail hit:0.0007, tail mean rank:7543.4884, topn:10.
2021-12-03 16:38:28,930 - root - INFO - avg hit:0.0379, avg mean rank:4604.7764, topn:10.
2021-12-03 16:38:48,077 - root - INFO - head hit:0.0769, head mean rank:1738.8750, topn:10.
2021-12-03 16:38:48,078 - root - INFO - tail hit:0.0007, tail mean rank:7414.2963, topn:10.
2021-12-03 16:38:48,078 - root - INFO - avg hit:0.0388, avg mean rank:4576.5856, topn:10.
2021-12-03 16:38:48,082 - root - INFO - No improvement after one epoch. Lowering learning rate.
2021-12-03 16:38:48,112 - root - INFO - No improvement after 70000 steps. Stopping training.
